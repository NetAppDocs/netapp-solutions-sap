---
sidebar: sidebar
permalink: backup/anf-cba-snapshot-based-backup-operations-of-the-hana-database.html
keywords: snapshot backup, cba topology, file system, sap hana studio
summary: "This section describes how to perform snapshot-based backup operations for the HANA database."
---

= Snapshot-based backup operations of the HANA database
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./../media/

//
// This file was created with NDAC Version 2.0 (August 17, 2020)
//
// 2023-03-16 10:24:27.263924
//

link:anf-cba-create-backup-policies.html[Preious: Create backup policies.]

== Assign policy to HANA system

To activate scheduled backups, the backup policy must be assigned to the HANA system.

. Go to *Assign Policy* > *Data Volume*.
+
image:anf-cba-image36.png["This screenshot shows the screen BlueXP > Backup and Recovery > Applications > system. Data volume dropdown is shown."]

. Click *Assign*.
+
image:anf-cba-image37.png["This screenshot shows the screen BlueXP > Backup and Recovery > Applications > Systems. The Assign selection screen is shown."]

. The policy is now assigned to the HANA system, and Snapshot backups are executed based on the schedule definition.
+
image:anf-cba-image38.png["This screenshot shows the screen BlueXP > Backup and Recovery > Applications > Systems. Basic policy info is filled in."]

== Create on-demand Snapshot backup

To create an on-demand database backup, complete the following steps:

. In the CBA dashboard view,  select *On-Demand Backup* > *Data Volume* in the context menu.
+
image:anf-cba-image39.png["Screenshot of step being completed."]

. In the *On-Demand Backup* dialog, select either *Policy-based* or *One time*.
+
** With *Policy-based*, the on-demand backup is treated in the same way as scheduled backups regarding the retention and pre- and post-script configuration.
** With *One time*, you can define a specific retention, a specific backup name, and specific pre- and post-scripts.

. In our example, we selected policy-based, and then we can select the policy and retention as the next step.
+
image:anf-cba-image40.png["Screenshot of step being completed."]
+
Within the Job Monitoring view, you can see the different workflow steps, the runtime of the steps, and the total operation runtime. In our example, the backup operation took around 1 minute.
+
image:anf-cba-image41.png["Screenshot of step being completed."]
+
image:anf-cba-image42.png["Screenshot of step being completed."]

== Review Snapshot backup information in CBA topology view

In the context menu of the CBA dashboard view, select *View Topology *to open the backup overview.

image:anf-cba-image43.png["Screenshot of step being completed."]

The backup overview shows the list of backups created by using CBA.

[NOTE]
The name of the backup follows the format that has been defined in the backup policy. The same naming convention is also used for the entry in the SAP HANA backup catalog and the Snapshot name on the ANF volume.

image:anf-cba-image44.png["Screenshot of step being completed."]

== Review Snapshot backup information in SAP HANA Studio

When performing a backup by using storage Snapshot copies for an SAP HANA MDC system, a Snapshot copy of the data volume is created. This data volume contains the data of the system database as well as the data of all tenant databases. To reflect this physical architecture, SAP HANA internally performs a combined backup of the system database and all tenant databases whenever CBA triggers a Snapshot backup. This results in multiple separate backup entries in the SAP HANA backup catalog: one for the system database and one for each tenant database.

In the SAP HANA backup catalog, the CBA backup name is stored in the Comment field and the External Backup ID (EBID) field, as shown in the following two figures. The following figures show the system database and the tenant database PR1. Both figures highlight the CBA backup name stored in the Comment field and EBID field.

[NOTE]
CBA is only aware of its own backups. Additional backups created, for example, with SAP HANA Studio, are visible in the SAP HANA catalog but not in CBA.

image:anf-cba-image45.png["Screenshot of step being completed."]

image:anf-cba-image46.png["Screenshot of step being completed."]

== Review Snapshot backup information in Azure Portal

The same name that is used as a backup name in CBA is also used as the Snapshot backup name on the ANF volume. The following figure shows the Azure portal and the Snapshot backups for the database data volume.

image:anf-cba-image47.png["This figure shows the Azure portal and the Snapshot backups for the database data volume."]


